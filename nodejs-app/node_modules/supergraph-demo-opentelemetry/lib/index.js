"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ApolloOpenTelemetry = void 0;
const api_1 = require("@opentelemetry/api");
const exporter_collector_1 = require("@opentelemetry/exporter-collector");
const exporter_zipkin_1 = require("@opentelemetry/exporter-zipkin");
const instrumentation_1 = require("@opentelemetry/instrumentation");
const instrumentation_express_1 = require("@opentelemetry/instrumentation-express");
const instrumentation_graphql_1 = require("@opentelemetry/instrumentation-graphql");
const instrumentation_http_1 = require("@opentelemetry/instrumentation-http");
const node_1 = require("@opentelemetry/node");
const resources_1 = require("@opentelemetry/resources");
const tracing_1 = require("@opentelemetry/tracing");
var GraphNodeType;
(function (GraphNodeType) {
    GraphNodeType["Router"] = "router";
    GraphNodeType["Subgraph"] = "subgraph";
})(GraphNodeType || (GraphNodeType = {}));
var ExporterType;
(function (ExporterType) {
    ExporterType["Console"] = "console";
    ExporterType["Zipkin"] = "zipkin";
    ExporterType["Collector"] = "collector";
})(ExporterType || (ExporterType = {}));
class ApolloOpenTelemetry {
    constructor(props) {
        this.props = props;
        if (props.debug) {
            api_1.diag.setLogger(new api_1.DiagConsoleLogger(), api_1.DiagLogLevel.DEBUG);
        }
    }
    setupInstrumentation() {
        var _a, _b, _c, _d, _e;
        const name = (_a = this.props.name) !== null && _a !== void 0 ? _a : this.props.type;
        const resource = new resources_1.Resource({
            'service.name': name,
        });
        const instrumentations = [];
        switch (this.props.type) {
            case GraphNodeType.Router:
                instrumentations.push(new instrumentation_http_1.HttpInstrumentation());
                instrumentations.push(new instrumentation_express_1.ExpressInstrumentation());
                break;
            case GraphNodeType.Subgraph:
                instrumentations.push(new instrumentation_http_1.HttpInstrumentation());
                instrumentations.push(new instrumentation_express_1.ExpressInstrumentation());
                instrumentations.push(new instrumentation_graphql_1.GraphQLInstrumentation({
                    allowValues: true,
                    depth: 10,
                }));
                break;
            default:
                throw new Error(`unknown graph node type: '${this.props.type}'`);
        }
        instrumentation_1.registerInstrumentations({
            instrumentations: [instrumentations],
        });
        const provider = new node_1.NodeTracerProvider({
            resource: resources_1.Resource.default().merge(resource),
        });
        const exporter = this.props.exporter;
        const exporterType = (_b = exporter === null || exporter === void 0 ? void 0 : exporter.type) !== null && _b !== void 0 ? _b : ExporterType.Console;
        const host = (_c = exporter === null || exporter === void 0 ? void 0 : exporter.host) !== null && _c !== void 0 ? _c : 'localhost';
        switch (exporterType) {
            case ExporterType.Console:
                const consoleExporter = new tracing_1.ConsoleSpanExporter();
                provider.addSpanProcessor(new tracing_1.SimpleSpanProcessor(consoleExporter));
                break;
            case ExporterType.Zipkin:
                const zipkinPort = (_d = exporter === null || exporter === void 0 ? void 0 : exporter.port) !== null && _d !== void 0 ? _d : '9411';
                const zipkinExporter = new exporter_zipkin_1.ZipkinExporter({
                    url: `http://${host}:${zipkinPort}/api/v2/spans`,
                });
                provider.addSpanProcessor(new tracing_1.SimpleSpanProcessor(zipkinExporter));
                break;
            case ExporterType.Collector:
                const collectorPort = (_e = exporter === null || exporter === void 0 ? void 0 : exporter.port) !== null && _e !== void 0 ? _e : '55681';
                const collectorTraceExporter = new exporter_collector_1.CollectorTraceExporter({
                    url: `http://${host}:${collectorPort}/v1/trace`,
                });
                provider.addSpanProcessor(new tracing_1.BatchSpanProcessor(collectorTraceExporter, {
                    maxQueueSize: 1000,
                    scheduledDelayMillis: 1000,
                }));
                break;
            default:
                throw new Error(`unknown exporter type: '${exporterType}'`);
        }
        provider.register();
    }
}
exports.ApolloOpenTelemetry = ApolloOpenTelemetry;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsNENBQTJFO0FBRTNFLDBFQUEyRTtBQUMzRSxvRUFBZ0U7QUFDaEUsb0VBR3dDO0FBQ3hDLG9GQUFnRjtBQUVoRixvRkFBZ0Y7QUFDaEYsOEVBQTBFO0FBQzFFLDhDQUF5RDtBQUN6RCx3REFBb0Q7QUFDcEQsb0RBQXNHO0FBR3RHLElBQUssYUFHSjtBQUhELFdBQUssYUFBYTtJQUNoQixrQ0FBaUIsQ0FBQTtJQUNqQixzQ0FBcUIsQ0FBQTtBQUN2QixDQUFDLEVBSEksYUFBYSxLQUFiLGFBQWEsUUFHakI7QUFFRCxJQUFLLFlBSUo7QUFKRCxXQUFLLFlBQVk7SUFDZixtQ0FBbUIsQ0FBQTtJQUNuQixpQ0FBaUIsQ0FBQTtJQUNqQix1Q0FBdUIsQ0FBQTtBQUN6QixDQUFDLEVBSkksWUFBWSxLQUFaLFlBQVksUUFJaEI7QUFnQkQsTUFBYSxtQkFBbUI7SUFHOUIsWUFBbUIsS0FBK0I7UUFDaEQsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFFbkIsSUFBSSxLQUFLLENBQUMsS0FBSyxFQUFFO1lBQ2YsVUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLHVCQUFpQixFQUFFLEVBQUUsa0JBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUM3RDtJQUNILENBQUM7SUFFTSxvQkFBb0I7O1FBQ3pCLE1BQU0sSUFBSSxHQUFHLE1BQUEsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLG1DQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDO1FBQ2hELE1BQU0sUUFBUSxHQUFHLElBQUksb0JBQVEsQ0FBQztZQUM1QixjQUFjLEVBQUUsSUFBSTtTQUNyQixDQUFDLENBQUM7UUFFSCxNQUFNLGdCQUFnQixHQUFzQixFQUFFLENBQUM7UUFDL0MsUUFBUSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRTtZQUN2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QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRpYWcsIERpYWdDb25zb2xlTG9nZ2VyLCBEaWFnTG9nTGV2ZWwgfSBmcm9tICdAb3BlbnRlbGVtZXRyeS9hcGknO1xuXG5pbXBvcnQgeyBDb2xsZWN0b3JUcmFjZUV4cG9ydGVyIH0gZnJvbSAnQG9wZW50ZWxlbWV0cnkvZXhwb3J0ZXItY29sbGVjdG9yJztcbmltcG9ydCB7IFppcGtpbkV4cG9ydGVyIH0gZnJvbSAnQG9wZW50ZWxlbWV0cnkvZXhwb3J0ZXItemlwa2luJztcbmltcG9ydCB7XG4gIEluc3RydW1lbnRhdGlvbixcbiAgcmVnaXN0ZXJJbnN0cnVtZW50YXRpb25zLFxufSBmcm9tICdAb3BlbnRlbGVtZXRyeS9pbnN0cnVtZW50YXRpb24nO1xuaW1wb3J0IHsgRXhwcmVzc0luc3RydW1lbnRhdGlvbiB9IGZyb20gJ0BvcGVudGVsZW1ldHJ5L2luc3RydW1lbnRhdGlvbi1leHByZXNzJztcblxuaW1wb3J0IHsgR3JhcGhRTEluc3RydW1lbnRhdGlvbiB9IGZyb20gJ0BvcGVudGVsZW1ldHJ5L2luc3RydW1lbnRhdGlvbi1ncmFwaHFsJztcbmltcG9ydCB7IEh0dHBJbnN0cnVtZW50YXRpb24gfSBmcm9tICdAb3BlbnRlbGVtZXRyeS9pbnN0cnVtZW50YXRpb24taHR0cCc7XG5pbXBvcnQgeyBOb2RlVHJhY2VyUHJvdmlkZXIgfSBmcm9tICdAb3BlbnRlbGVtZXRyeS9ub2RlJztcbmltcG9ydCB7IFJlc291cmNlIH0gZnJvbSAnQG9wZW50ZWxlbWV0cnkvcmVzb3VyY2VzJztcbmltcG9ydCB7IEJhdGNoU3BhblByb2Nlc3NvciwgQ29uc29sZVNwYW5FeHBvcnRlciwgU2ltcGxlU3BhblByb2Nlc3NvciB9IGZyb20gJ0BvcGVudGVsZW1ldHJ5L3RyYWNpbmcnO1xuXG5cbmVudW0gR3JhcGhOb2RlVHlwZSB7XG4gIFJvdXRlciA9ICdyb3V0ZXInLFxuICBTdWJncmFwaCA9ICdzdWJncmFwaCcsXG59XG5cbmVudW0gRXhwb3J0ZXJUeXBlIHtcbiAgQ29uc29sZSA9ICdjb25zb2xlJyxcbiAgWmlwa2luID0gJ3ppcGtpbicsXG4gIENvbGxlY3RvciA9ICdjb2xsZWN0b3InLFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFwb2xsb09wZW5UZWxlbWV0cnlFeHBvcnRlclByb3BzIHtcbiAgcmVhZG9ubHkgdHlwZTogRXhwb3J0ZXJUeXBlO1xuICByZWFkb25seSBob3N0Pzogc3RyaW5nO1xuICByZWFkb25seSBwb3J0Pzogc3RyaW5nO1xufVxuXG5cbmV4cG9ydCBpbnRlcmZhY2UgQXBvbGxvT3BlblRlbGVtZXRyeVByb3BzIHtcbiAgcmVhZG9ubHkgdHlwZTogR3JhcGhOb2RlVHlwZTtcbiAgcmVhZG9ubHkgbmFtZT86IHN0cmluZztcbiAgcmVhZG9ubHkgZXhwb3J0ZXI/OiBBcG9sbG9PcGVuVGVsZW1ldHJ5RXhwb3J0ZXJQcm9wcztcbiAgcmVhZG9ubHkgZGVidWc/OiBib29sZWFuO1xufVxuXG5leHBvcnQgY2xhc3MgQXBvbGxvT3BlblRlbGVtZXRyeSB7XG4gIHByaXZhdGUgcHJvcHM6IEFwb2xsb09wZW5UZWxlbWV0cnlQcm9wc1xuXG4gIHB1YmxpYyBjb25zdHJ1Y3Rvcihwcm9wczogQXBvbGxvT3BlblRlbGVtZXRyeVByb3BzKSB7XG4gICAgdGhpcy5wcm9wcyA9IHByb3BzO1xuXG4gICAgaWYgKHByb3BzLmRlYnVnKSB7XG4gICAgICBkaWFnLnNldExvZ2dlcihuZXcgRGlhZ0NvbnNvbGVMb2dnZXIoKSwgRGlhZ0xvZ0xldmVsLkRFQlVHKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgc2V0dXBJbnN0cnVtZW50YXRpb24oKSB7XG4gICAgY29uc3QgbmFtZSA9IHRoaXMucHJvcHMubmFtZSA/PyB0aGlzLnByb3BzLnR5cGU7XG4gICAgY29uc3QgcmVzb3VyY2UgPSBuZXcgUmVzb3VyY2Uoe1xuICAgICAgJ3NlcnZpY2UubmFtZSc6IG5hbWUsXG4gICAgfSk7XG5cbiAgICBjb25zdCBpbnN0cnVtZW50YXRpb25zOiBJbnN0cnVtZW50YXRpb25bXSA9IFtdO1xuICAgIHN3aXRjaCAodGhpcy5wcm9wcy50eXBlKSB7XG4gICAgICBjYXNlIEdyYXBoTm9kZVR5cGUuUm91dGVyOlxuICAgICAgICBpbnN0cnVtZW50YXRpb25zLnB1c2goIG5ldyBIdHRwSW5zdHJ1bWVudGF0aW9uKCkgKTtcbiAgICAgICAgaW5zdHJ1bWVudGF0aW9ucy5wdXNoKCBuZXcgRXhwcmVzc0luc3RydW1lbnRhdGlvbigpICk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIEdyYXBoTm9kZVR5cGUuU3ViZ3JhcGg6XG4gICAgICAgIGluc3RydW1lbnRhdGlvbnMucHVzaCggbmV3IEh0dHBJbnN0cnVtZW50YXRpb24oKSApO1xuICAgICAgICBpbnN0cnVtZW50YXRpb25zLnB1c2goIG5ldyBFeHByZXNzSW5zdHJ1bWVudGF0aW9uKCkgKTtcbiAgICAgICAgaW5zdHJ1bWVudGF0aW9ucy5wdXNoKFxuICAgICAgICAgIG5ldyBHcmFwaFFMSW5zdHJ1bWVudGF0aW9uKHtcbiAgICAgICAgICAgIGFsbG93VmFsdWVzOiB0cnVlLFxuICAgICAgICAgICAgZGVwdGg6IDEwLFxuICAgICAgICAgIH0pLFxuICAgICAgICApO1xuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGB1bmtub3duIGdyYXBoIG5vZGUgdHlwZTogJyR7dGhpcy5wcm9wcy50eXBlfSdgKTtcbiAgICB9XG5cbiAgICByZWdpc3Rlckluc3RydW1lbnRhdGlvbnMoe1xuICAgICAgaW5zdHJ1bWVudGF0aW9uczogW2luc3RydW1lbnRhdGlvbnNdLFxuICAgIH0pO1xuICAgIGNvbnN0IHByb3ZpZGVyID0gbmV3IE5vZGVUcmFjZXJQcm92aWRlcih7XG4gICAgICByZXNvdXJjZTogUmVzb3VyY2UuZGVmYXVsdCgpLm1lcmdlKHJlc291cmNlKSxcbiAgICB9KTtcblxuICAgIGNvbnN0IGV4cG9ydGVyID0gdGhpcy5wcm9wcy5leHBvcnRlcjtcbiAgICBjb25zdCBleHBvcnRlclR5cGUgPSBleHBvcnRlcj8udHlwZSA/PyBFeHBvcnRlclR5cGUuQ29uc29sZTtcbiAgICBjb25zdCBob3N0ID0gZXhwb3J0ZXI/Lmhvc3QgPz8gJ2xvY2FsaG9zdCc7XG5cbiAgICBzd2l0Y2ggKGV4cG9ydGVyVHlwZSkge1xuICAgICAgY2FzZSBFeHBvcnRlclR5cGUuQ29uc29sZTpcbiAgICAgICAgY29uc3QgY29uc29sZUV4cG9ydGVyID0gbmV3IENvbnNvbGVTcGFuRXhwb3J0ZXIoKTtcbiAgICAgICAgcHJvdmlkZXIuYWRkU3BhblByb2Nlc3NvcihcbiAgICAgICAgICBuZXcgU2ltcGxlU3BhblByb2Nlc3Nvcihjb25zb2xlRXhwb3J0ZXIpLFxuICAgICAgICApO1xuXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIEV4cG9ydGVyVHlwZS5aaXBraW46XG4gICAgICAgIGNvbnN0IHppcGtpblBvcnQgPSBleHBvcnRlcj8ucG9ydCA/PyAnOTQxMSc7XG5cbiAgICAgICAgY29uc3Qgemlwa2luRXhwb3J0ZXIgPSBuZXcgWmlwa2luRXhwb3J0ZXIoe1xuICAgICAgICAgIHVybDogYGh0dHA6Ly8ke2hvc3R9OiR7emlwa2luUG9ydH0vYXBpL3YyL3NwYW5zYCxcbiAgICAgICAgfSk7XG4gICAgICAgIHByb3ZpZGVyLmFkZFNwYW5Qcm9jZXNzb3IoXG4gICAgICAgICAgbmV3IFNpbXBsZVNwYW5Qcm9jZXNzb3Ioemlwa2luRXhwb3J0ZXIpLFxuICAgICAgICApO1xuXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIEV4cG9ydGVyVHlwZS5Db2xsZWN0b3I6XG4gICAgICAgIGNvbnN0IGNvbGxlY3RvclBvcnQgPSBleHBvcnRlcj8ucG9ydCA/PyAnNTU2ODEnO1xuXG4gICAgICAgIGNvbnN0IGNvbGxlY3RvclRyYWNlRXhwb3J0ZXIgPSBuZXcgQ29sbGVjdG9yVHJhY2VFeHBvcnRlcih7XG4gICAgICAgICAgdXJsOiBgaHR0cDovLyR7aG9zdH06JHtjb2xsZWN0b3JQb3J0fS92MS90cmFjZWAsXG4gICAgICAgIH0pO1xuICAgICAgICBwcm92aWRlci5hZGRTcGFuUHJvY2Vzc29yKFxuICAgICAgICAgIG5ldyBCYXRjaFNwYW5Qcm9jZXNzb3IoY29sbGVjdG9yVHJhY2VFeHBvcnRlciwge1xuICAgICAgICAgICAgbWF4UXVldWVTaXplOiAxMDAwLFxuICAgICAgICAgICAgc2NoZWR1bGVkRGVsYXlNaWxsaXM6IDEwMDAsXG4gICAgICAgICAgfSksXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHVua25vd24gZXhwb3J0ZXIgdHlwZTogJyR7ZXhwb3J0ZXJUeXBlfSdgKTtcbiAgICB9XG4gICAgcHJvdmlkZXIucmVnaXN0ZXIoKTtcbiAgfVxufSJdfQ==